---
title: "Carbon Life Cycle - Descriptive Analysis (210527_dat_ftf.rds)"
author: "Juliana Sch√§fer"
date: "`r Sys.Date()`"
output: 
  pdf_document: 
    extra_dependencies: ["float"]
    fig_width: 10
    fig_height: 4
    number_sections: yes
    toc: yes
    toc_depth: 5
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.pos = "!H", out.extra = "")
library(ggplot2)
library(RColorBrewer)
library(tidyverse)
library(data.table)

source("Functions.R")

# Reading of the data:
user <- "juliana"
if (user == "max") {
  dat <- readRDS("C:/Users/ri87nix/LRZ Sync+Share/TourIST_neu/TourIST_2021-03-07T0005/Daten/Daten_aufbereitet/210527_dat_ftf.rds")
}
if (user == "alex") {
  
}
if (user == "juliana") {
  dat <- readRDS("~/LRZ Sync+Share/TourIST_neu (Alexander Bauer)/TourIST_2021-03-07T0005/Daten/Daten_aufbereitet/210527_dat_ftf.rds")
}

theme <- theme_minimal() +
    theme(text = element_text(size = 14), axis.title = element_text(size = 14),
          axis.text = element_text(size = 8),
          legend.text = element_text(size = 8),
          plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
          strip.text.y = element_text(size = 14), legend.text.align = 0,
          strip.placement = "outside", strip.background = element_blank(),
          axis.title.y = element_text(margin = margin(0, 10, 0, 0)),
          axis.title.x = element_text(margin = margin(10, 0, 0, 0)))

setDT(dat)

source("Preparations.R")

levels(dat$JS_HUR_Reisebegleitung_KinderJug_binaer) <- c("-99", "Vacation \n with children", "Vacation \n without children")

# dat <- dat[travel_year >= 1980]

```

\clearpage

# Travel expenses
## Travel expenses total expenses (JS_Gesamt_Ausgaben)
### By Travel Year
```{r  echo=FALSE, warning=FALSE}

ggplot(data = dat, aes(x = as.factor(travel_year), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period", y = "Travel expenses")

ggplot(data = dat[!is.na(travel_year)],
       aes(x = as.factor(travel_year), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period (no NAs)", y = "Travel expenses")
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(travel_year), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 3500)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period", y = "Travel expenses")
# ggsave("Figures/Expenses_Period.png", width = 8, height = 4.5)
# ggsave("Figures/Expenses_Period.pdf", width = 8, height = 4.5)

ggplot(data = dat[!is.na(travel_year)],
       aes(x = as.factor(travel_year), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 3500)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period (no NAs)", y = "Travel expenses")
```

### By Age
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Alter), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age", y = "Travel expenses")

ggplot(data = dat[!is.na(S_Alter)], 
       aes(x = as.factor(S_Alter), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age (no NAs)", y = "Travel expenses")
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Alter), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 3500)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age", y = "Travel expenses")
# ggsave("Figures/Expenses_Age.png", width = 8, height = 4.5)
# ggsave("Figures/Expenses_Age.pdf", width = 8, height = 4.5)

ggplot(data = dat[!is.na(S_Alter)],
       aes(x = as.factor(S_Alter), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 3500)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age (no NAs)", y = "Travel expenses")
```

### By Cohort
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Jahrgang), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort", y = "Travel expenses")

ggplot(data = dat[!is.na(S_Jahrgang)],
       aes(x = as.factor(S_Jahrgang), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort (no NAs)", y = "Travel expenses")
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Jahrgang), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 4000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort", y = "Travel expenses")
# ggsave("Figures/Expenses_Cohort.png", width = 8, height = 4.5)
# ggsave("Figures/Expenses_Cohort.pdf", width = 8, height = 4.5)

ggplot(data = dat[!is.na(S_Jahrgang)],
       aes(x = as.factor(S_Jahrgang), y = JS_Gesamt_Ausgaben)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 4000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort (no NAs)", y = "Travel expenses")
```


\clearpage

## Travel expenses main vacation (JS_HUR_Ausgaben_gesamt)
### By Travel Year
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(travel_year), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(travel_year)], 
       aes(x = as.factor(travel_year), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period (no NAs)", y = "Travel expenses")
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(travel_year), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 3500)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period", y = "Travel expenses")
```


```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(travel_year)],
       aes(x = as.factor(travel_year), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 3500)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period (no NAs)", y = "Travel expenses")
```

### By Age
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Alter), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Alter)],
       aes(x = as.factor(S_Alter), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age (no NAs)", y = "Travel expenses")
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Alter), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 3000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Alter)],
       aes(x = as.factor(S_Alter), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 3000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age (no NAs)", y = "Travel expenses")
```

### By Cohort
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Jahrgang), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Jahrgang)],
       aes(x = as.factor(S_Jahrgang), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort (no NAs)", y = "Travel expenses")
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Jahrgang), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 4000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Jahrgang)],
       aes(x = as.factor(S_Jahrgang), y = JS_HUR_Ausgaben_gesamt)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 4000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort (no NAs)", y = "Travel expenses")
```
\clearpage

## Travel expenses main vacation per person (JS_HUR_Ausgaben_pP)
### Total
**By Travel Year**
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(travel_year), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(travel_year)],
       aes(x = as.factor(travel_year), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period (no NAs)", y = "Travel expenses")
```

Zoomed in for better vision:
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(travel_year), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 2000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(travel_year)],
       aes(x = as.factor(travel_year), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 2000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period (no NAs)", y = "Travel expenses")
```

**By Age**
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Alter), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Alter)],
       aes(x = as.factor(S_Alter), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age (no NAs)", y = "Travel expenses")
```

Zoomed in for better vision:
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Alter), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 3000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Alter)],
       aes(x = as.factor(S_Alter), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 3000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Age (no NAs)", y = "Travel expenses")
```

**By Cohort**
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Jahrgang), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Jahrgang)],
       aes(x = as.factor(S_Jahrgang), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort (no NAs)", y = "Travel expenses")
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat, aes(x = as.factor(S_Jahrgang), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 4000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 10,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort", y = "Travel expenses")
```

```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Jahrgang)],
       aes(x = as.factor(S_Jahrgang), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  coord_cartesian(ylim = c(0, 4000)) +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  labs(x = "Cohort (no NAs)", y = "Travel expenses")
```

### Children
**By Travel Year**
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(travel_year) & !is.na(JS_HUR_Reisebegleitung_KinderJug_binaer) & JS_HUR_Reisebegleitung_KinderJug_binaer != -99],
       aes(x = as.factor(travel_year), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period (no NAs)", y = "Travel expenses (no NAs)") +
  facet_grid(vars(JS_HUR_Reisebegleitung_KinderJug_binaer))
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(travel_year) & !is.na(JS_HUR_Reisebegleitung_KinderJug_binaer) & JS_HUR_Reisebegleitung_KinderJug_binaer != -99],
       aes(x = as.factor(travel_year), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  coord_cartesian(ylim = c(0, 2000)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Period (no NAs)", y = "Travel expenses (no NAs)") +
  facet_grid(vars(JS_HUR_Reisebegleitung_KinderJug_binaer))

```

**By Age**
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Alter) & !is.na(JS_HUR_Reisebegleitung_KinderJug_binaer) & JS_HUR_Reisebegleitung_KinderJug_binaer != -99],
       aes(x = as.factor(S_Alter), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Age (no NAs)", y = "Travel expenses (no NAs)") +
  facet_grid(vars(JS_HUR_Reisebegleitung_KinderJug_binaer))

```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Alter) & !is.na(JS_HUR_Reisebegleitung_KinderJug_binaer) & JS_HUR_Reisebegleitung_KinderJug_binaer != -99],
       aes(x = as.factor(S_Alter), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  coord_cartesian(ylim = c(0, 3500)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Age (no NAs)", y = "Travel expenses (no NAs)") +
  facet_grid(vars(JS_HUR_Reisebegleitung_KinderJug_binaer))
```

**By Cohort**
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Jahrgang) & !is.na(JS_HUR_Reisebegleitung_KinderJug_binaer) & JS_HUR_Reisebegleitung_KinderJug_binaer != -99],
       aes(x = as.factor(S_Jahrgang), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Cohort (no NAs)", y = "Travel expenses (no NAs)") +
  facet_grid(vars(JS_HUR_Reisebegleitung_KinderJug_binaer))
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
ggplot(data = dat[!is.na(S_Jahrgang) & !is.na(JS_HUR_Reisebegleitung_KinderJug_binaer) & JS_HUR_Reisebegleitung_KinderJug_binaer != -99],
       aes(x = as.factor(S_Jahrgang), y = JS_HUR_Ausgaben_pP)) +
  geom_boxplot(outlier.size = 0.5, fill = "#9ECAE1") +
  theme +
  theme(axis.text.x = element_text(angle = 90, size = 8,
                                   vjust = 0.5, hjust = 1,
                                   color = rep(c("black","transparent"), 65))) +
  coord_cartesian(ylim = c(0, 3500)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Cohort (no NAs)", y = "Travel expenses (no NAs)") +
  facet_grid(vars(JS_HUR_Reisebegleitung_KinderJug_binaer))
```


\newpage

# Household income (S_Einkommen_HH)
## By Travel Year
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat, xlab = "Period (no NAs)", ylab = "Household income",
          legend_title = NULL, x = "travel_year", y = "S_Einkommen_HH",
          y_names = NULL, no_nas = TRUE)
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat, xlab = "Period (no NAs)", ylab = "Household income",
          legend_title = NULL, x = "travel_year", y = "S_Einkommen_HH",
          y_names = NULL, no_nas = TRUE) +
  coord_cartesian(ylim = c(0, 5000))
```

## By Age
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat, xlab = "Age (no NAs)", ylab = "Household income",
          legend_title = NULL, x = "S_Alter", y = "S_Einkommen_HH",
          y_names = NULL, no_nas = TRUE)
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat, xlab = "Age (no NAs)", ylab = "Household income",
          legend_title = NULL, x = "S_Alter", y = "S_Einkommen_HH",
          y_names = NULL, no_nas = TRUE) +
  coord_cartesian(ylim = c(0, 5000))
```

## By Cohort
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat, xlab = "Cohort (no NAs)", ylab = "Household income",
          legend_title = NULL, x = "S_Jahrgang", y = "S_Einkommen_HH",
          y_names = NULL, no_nas = TRUE)
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat, xlab = "Cohort (no NAs)", ylab = "Household income",
          legend_title = NULL, x = "S_Jahrgang", y = "S_Einkommen_HH",
          y_names = NULL, no_nas = TRUE) +
  coord_cartesian(ylim = c(0, 5000))
```
\newpage

# Household size (S_Haushaltsgroesse)
## By Travel Year
```{r  echo=FALSE, warning=FALSE}
plot_freq(data = dat, legend_title = "Household size",
          x = "travel_year", y = "S_Haushaltsgroesse", xlab = "Period",
          y_names = c("1 person", "2 persons", "3 persons", "4 persons", "5 persons and more", "Not specified", "NA"),
          no_nas = FALSE)

plot_freq(data = dat[S_Haushaltsgroesse != "keine Angabe"], 
          legend_title = "Household size \n(no NAs)",
          x = "travel_year", y = "S_Haushaltsgroesse", xlab = "Period (no NAs)",
          y_names = c("1 person", "2 persons", "3 persons", "4 persons", "5 persons and more"),
          no_nas = TRUE)

plot_line(data = dat[S_Haushaltsgroesse != "keine Angabe"],
          xlab = "Period", 
          ylab = "Relative frequency",
          legend_title = "Household size \n(no NAs)", x = "travel_year", y = "prop",
          y_names = c("1 person", "2 persons", "3 persons", "4 persons", "5 persons and more"),
          no_nas = TRUE,
          group = "S_Haushaltsgroesse") +
  coord_cartesian(ylim = c(0, 1))

```

## By Age
```{r  echo=FALSE, warning=FALSE}
plot_freq(data = dat, legend_title = "Household size",
          x = "S_Alter", y = "S_Haushaltsgroesse", xlab = "Age",
          y_names = c("1 person", "2 persons", "3 persons", "4 persons", "5 persons and more", "Not specified", "NA"),
          no_nas = FALSE)

plot_freq(data = dat[S_Haushaltsgroesse != "keine Angabe"],
          legend_title = "Household size \n(no NAs)",
          x = "S_Alter", y = "S_Haushaltsgroesse", xlab = "Age (no NAs)",
          y_names = c("1 person", "2 persons", "3 persons", "4 persons", "5 persons and more"),
          no_nas = TRUE)

plot_line(data = dat[S_Haushaltsgroesse != "keine Angabe"],
          xlab = "Age", 
          ylab = "Relative frequency",
          legend_title = "Household size \n(no NAs)", x = "S_Alter", y = "prop",
          y_names = c("1 person", "2 persons", "3 persons", "4 persons", "5 persons and more"),
          no_nas = TRUE,
          group = "S_Haushaltsgroesse") +
  coord_cartesian(ylim = c(0, 1))
```

## By Cohort
```{r  echo=FALSE, warning=FALSE}
plot_freq(data = dat, legend_title = "Household size",
          x = "S_Jahrgang", y = "S_Haushaltsgroesse", xlab = "Cohort",
          y_names = c("1 person", "2 persons", "3 persons", "4 persons", "5 persons and more", "Not specified", "NA"),
          no_nas = FALSE)

plot_freq(data = dat[S_Haushaltsgroesse != "keine Angabe"],
          legend_title = "Household size \n(no NAs)",
          x = "S_Jahrgang", y = "S_Haushaltsgroesse", xlab = "Cohort (no NAs)",
          y_names = c("1 person", "2 persons", "3 persons", "4 persons", "5 persons and more"),
          no_nas = TRUE)

plot_line(data = dat[S_Haushaltsgroesse != "keine Angabe"],
          xlab = "Cohort", 
          ylab = "Relative frequency",
          legend_title = "Household size \n(no NAs)", x = "S_Jahrgang", y = "prop",
          y_names = c("1 person", "2 persons", "3 persons", "4 persons", "5 persons and more"),
          no_nas = TRUE,
          group = "S_Haushaltsgroesse") +
  coord_cartesian(ylim = c(0, 1))
```

\newpage

# Share of household income spent on main vacation trip (JS_HUR_Ausgaben_AnteilEinkHH)
## By Travel Year
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat,
             xlab = "Period", 
             ylab = "Share of household income \n spent on main vacation trip",
             legend_title = NULL, x = "travel_year", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = FALSE) +
  geom_hline(yintercept = 1, col = "red") 

plot_boxplot(data = dat[!is.na(JS_HUR_Ausgaben_AnteilEinkHH) & JS_HUR_Ausgaben_AnteilEinkHH > 0],
             xlab = "Period (no NAs)", 
             ylab = "Share of household income \n spent on main vacation trip (no NAs)",
             legend_title = NULL, x = "travel_year", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = TRUE) +
  geom_hline(yintercept = 1, col = "red") 
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat,
             xlab = "Period", 
             ylab = "Share of household income \n spent on main vacation trip",
             legend_title = NULL, x = "travel_year", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = FALSE) +
  geom_hline(yintercept = 1, col = "red") +
  coord_cartesian(ylim = c(0, 3))

plot_boxplot(data = dat[!is.na(JS_HUR_Ausgaben_AnteilEinkHH) & JS_HUR_Ausgaben_AnteilEinkHH > 0],
             xlab = "Period (no NAs)", 
             ylab = "Share of household income \n spent on main vacation trip (no NAs)",
             legend_title = NULL, x = "travel_year", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = TRUE) +
  geom_hline(yintercept = 1, col = "red") +
  coord_cartesian(ylim = c(0, 3))

```

## By Age
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat,
             xlab = "Age", 
             ylab = "Share of household income \n spent on main vacation trip",
             legend_title = NULL, x = "S_Alter", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = FALSE) +
  geom_hline(yintercept = 1, col = "red") 

plot_boxplot(data = dat[!is.na(JS_HUR_Ausgaben_AnteilEinkHH) & JS_HUR_Ausgaben_AnteilEinkHH > 0],
             xlab = "Age (no NAs)", 
             ylab = "Share of household income \n spent on main vacation trip (no NAs)",
             legend_title = NULL, x = "S_Alter", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = TRUE) +
  geom_hline(yintercept = 1, col = "red") 
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat,
             xlab = "Age", 
             ylab = "Share of household income \n spent on main vacation trip",
             legend_title = NULL, x = "S_Alter", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = FALSE) +
  geom_hline(yintercept = 1, col = "red") +
  coord_cartesian(ylim = c(0, 3))

plot_boxplot(data = dat[!is.na(JS_HUR_Ausgaben_AnteilEinkHH) & JS_HUR_Ausgaben_AnteilEinkHH > 0],
             xlab = "Age (no NAs)", 
             ylab = "Share of household income \n spent on main vacation trip (no NAs)",
             legend_title = NULL, x = "S_Alter", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = TRUE) +
  geom_hline(yintercept = 1, col = "red") +
  coord_cartesian(ylim = c(0, 3))
```

## By Cohort
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat,
             xlab = "Cohort", 
             ylab = "Share of household income \n spent on main vacation trip",
             legend_title = NULL, x = "S_Jahrgang", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = FALSE) +
  geom_hline(yintercept = 1, col = "red") 

plot_boxplot(data = dat[!is.na(JS_HUR_Ausgaben_AnteilEinkHH) & JS_HUR_Ausgaben_AnteilEinkHH > 0],
             xlab = "Cohort (no NAs)", 
             ylab = "Share of household income \n spent on main vacation trip (no NAs)",
             legend_title = NULL, x = "S_Jahrgang", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = TRUE) +
  geom_hline(yintercept = 1, col = "red") 
```

Zoomed in for better vision:  
```{r  echo=FALSE, warning=FALSE}
plot_boxplot(data = dat,
             xlab = "Cohort", 
             ylab = "Share of household income \n spent on main vacation trip",
             legend_title = NULL, x = "S_Jahrgang", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = FALSE) +
  geom_hline(yintercept = 1, col = "red") +
  coord_cartesian(ylim = c(0, 3))

plot_boxplot(data = dat[!is.na(JS_HUR_Ausgaben_AnteilEinkHH) & JS_HUR_Ausgaben_AnteilEinkHH > 0],
             xlab = "Cohort (no NAs)", 
             ylab = "Share of household income \n spent on main vacation trip (no NAs)",
             legend_title = NULL, x = "S_Jahrgang", y = "JS_HUR_Ausgaben_AnteilEinkHH",
             y_names = NULL, no_nas = TRUE) +
  geom_hline(yintercept = 1, col = "red") +
  coord_cartesian(ylim = c(0, 3))


#####
beepr::beep()

```




